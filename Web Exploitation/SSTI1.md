Link thử thách: https://play.picoctf.org/practice/challenge/492?difficulty=1&page=1</br>
Dựa vào tên thử thách và gợi ý thì nhiều khả năng xuất hiện lỗ hổng Server-Side-Template-Injection. Đây là một lỗ hổng bảo mật xảy ra khi ứng dụng web sử dụng một công cụ tạo mẫu (template engine) để nhúng dữ liệu người dùng vào trang web mà không kiểm soát kỹ dữ liệu đó.</br>
Đây là giao diện của trang web. Bây giờ mục tiêu ta sẽ nhập thử một số lệnh xem trang web có thực sự có lỗ hổng không. </br>
<p> 
  <img width="1594" height="964" alt="image" src="https://github.com/user-attachments/assets/f445022f-5044-4540-b203-69832c9e52ba" />
</p>
Với một trang web an toàn thì khi nhập input vào thì output thông báo ra cũng phải tương tự. Tuy nhiên trong bài này thì nó lại hiện ra kết quả của phép tính là 49 -> có lỗ hổng SSTI. </br>
<p>
  <img width="597" height="199" alt="image" src="https://github.com/user-attachments/assets/3595d5cf-4d04-4e37-9c20-b0dcd74039ee" />
</p>
<p>
<img width="1594" height="357" alt="image" src="https://github.com/user-attachments/assets/9bf32770-a39b-47d5-bfbe-e51d026b94e9" />
</p>
Tiếp theo ta sẽ tiếp tục thử để xác định được engine( Công cụ tạp mẫu ). Việc này nhằm xác định rõ được cái Payload(mã độc) phù hợp. </br>
Thử với Payload {{7*'7'}} </br>
<p>
  <img width="608" height="249" alt="image" src="https://github.com/user-attachments/assets/fa38975f-3efd-4550-999f-85b80a75b0bd" />
</p>
Ta nhận được thông báo </br>
<p>
  <img width="1409" height="353" alt="image" src="https://github.com/user-attachments/assets/4e93bf03-5dc0-42bc-89ce-a8c6d747a8b6" />
</p>
Từ đây ta suy ra ngay được engine là Jinja2 (Python) </br>
Ta sẽ tiến hành khám phá các đối tượng có sẵn của trang web. Ta dùng Payload {{ config.items() }} hoặc {{ self.__dict__ }} </br>
Với {{ config.items() }} ta thấy </br>
<p> <img width="581" height="300" alt="image" src="https://github.com/user-attachments/assets/415856ec-caa5-48a2-a48a-f41a61eb41d0" />
</p>
Đầu ra ta nhận được </br>
<p>
  <img width="1911" height="416" alt="image" src="https://github.com/user-attachments/assets/9c22ab09-4e33-46d5-ab1a-1afee949aaf7" />
</p>
Giá trị của Secret_Key là none vì vậy nhiều khả năng flag sẽ không ở config. </br>
Chuyển sang thử với {{ self.__dict__ }} </br>
<p>
  <img width="717" height="328" alt="image" src="https://github.com/user-attachments/assets/25e3dbe2-17b0-4bd0-adc3-9a0c12e9283e" />
</p>
Ta nhận được kết quả </br>
<p>
  <img width="1908" height="523" alt="image" src="https://github.com/user-attachments/assets/69c19616-c5d8-4aa0-90f9-e531ce533be5" />
</p>
Ở đây ta thấy đang ở môi trường Flask và cung cấp cho chúng ta config, request và đặc biệt là url_for. </br>
Đối tượng url_for có quyền truy cập vào _ _globals_ _ từ đó dẫn đến module os để thực thi lệnh -> Ta sẽ sử dụng </br>
<p>
  <img width="591" height="257" alt="image" src="https://github.com/user-attachments/assets/934accff-0203-4351-ac99-d1e322479f15" />
</p>
Và kết quả thật tuyệt. Ta đã thấy file flag. </br>
<p>
  <img width="1700" height="508" alt="image" src="https://github.com/user-attachments/assets/203268c5-d7b6-4ed1-98ab-fc6ff07c29f7" />
</p>
Bây giờ ta chỉ cần đọc file flag để lấy cờ. DÙng lệnh {{ url_for.__globals__['os'].popen('cat flag').read() }} </br>
<p>
  <img width="1848" height="307" alt="image" src="https://github.com/user-attachments/assets/d7838061-df62-4671-952e-190f8d744340" />
</p>
Và ta được flag cần tìm: picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_f5438664}.
